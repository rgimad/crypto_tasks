q = рандомное 128 бит
p = q*2^128 + 1
while (not isPrime(p)) {
    p = p + 2*q
}
gamma = рандомное из 1..2^128 - 1
g = gamma^((p-1)/q) mod p
x = рандомное из 1..q-1
y = g^x mod p
k = рандомное ? бит
r = g^k mod p         // r - 256 бит
h = hash(сообщение)
s = .....             // s - 128 бит

// проверка подписи:
// публичные данные: p, g, y 
// отсоединяем подпись т.е r и s
// считаем h - хэш сообщения
// проверяем уравнение проверки

.